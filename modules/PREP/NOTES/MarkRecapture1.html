---
layout: page
title: Mark-Recapture I Notes
author: Derek H. Ogle
css: /css/codebox.css
---


<p>The size of a population can be estimated by capturing individuals from the population, marking those individuals and returning them to the population, extracting another sample from the population, and determining the fraction of individuals in the second sample that had the mark from the first sample. This idea was first used to estimate the population of humans in London in 1662 <span class="citation">(Krebs 1999)</span>, but was popularized in fisheries by C.G.J. Petersen in 1896 <span class="citation">(Ricker 1975)</span>. The method was used by <span class="citation">Lincoln (1930)</span> for estimating duck populations and by <span class="citation">Jackson (1933)</span> for estimating tsetse fly populations. Thus, this method is variously referred to as the Petersen method, the Lincoln-Petersen method, or the Lincoln-Petersen-Jackson method. “Petersen method” will be used here</p>
<p>The Petersen method, which relies on only one sample of potentially marked fish, can be extended to a series of samples. These extended methods, called the Schnabel and Schumacher-Eschmeyer methods, require at least one sample where fish are marked and then multiple samples of potentially marked fish. However, these methods are most often used when the unmarked fish in the subsequent samples are marked and returned, along with the previously marked fish, to the population. Thus, these methods can be used with multiple marking and multiple “recapturing” samples.</p>
<div id="some-notational-conventions" class="section level3">
<h3>Some Notational Conventions</h3>
<p>The discusson below requires counting the frequency of individuals with each capture history. These frequencies are typically symbolized with a lower-case “n” and the capture history string as a subscript. For example, <span class="math inline">\(n_{10100}\)</span> represents the number of fish captured in the first and third sample periods but not in any other sample period.</p>
<p>This terminology is extended to represent other frequencies by including a “dot” (i.e., <span class="math inline">\(\cdot\)</span>) in any part of the subscript that is “summed across.” For example, <span class="math inline">\(n_{\cdot\cdot1\cdot\cdot}\)</span> represents the frequency of fish that were captured in the third sample (i.e., a “1” in the third sample position) and either were or were not captured in any of the other samples. In other words, <span class="math inline">\(n_{\cdot\cdot1\cdot\cdot}\)</span> represents the total number of fish captured in the third sample. Traditionally, this value is also referred to as <span class="math inline">\(n_{3}\)</span>, where the subscript now represents the sample number and not a capture history type. As another example, <span class="math inline">\(n_{\cdot101\cdot}\)</span> represents the number of fish captured in the fourth sample that were <em>last</em> captured in the second sample. These and other counts will have specific symbols when used in the context of the specific methods below.</p>
<p> </p>
<hr />
</div>
<div id="single-census-mark-recapture-methods" class="section level1">
<h1>Single Census Mark-Recapture Methods</h1>
<div id="petersen-method" class="section level3">
<h3>Petersen Method</h3>
<p>The Petersen method consists of two samples from a closed population and is, thus, the simplest of the broad array of mark-recapture techniques for estimating animal abundance. The population and sampling scheme for the two samples (<span class="math inline">\(i=1,2\)</span>) of the Petersen method are represented in Figure 1. The large squares just to the left of the “i=” vertical lines represent the population just before the <span class="math inline">\(i\)</span>th sample is taken. The large square just after the “i=1” vertical line represents the population just after the first sample was taken. Thus, under the assumption that the population is closed, the population immediately after the first sample is the same as the population immediately before the second sample. The samples are represented by the small grey boxes just above each “i=” vertical line.</p>
<p><img src="Petersen_Scheme.jpg" /></p>
<p>Figure 1: Schematic representation of the two samples (<span class="math inline">\(i=1,2\)</span>) in a Petersen mark-recapture study. See the text for detailed description and Table 2 for definitions of notation.</p>
<p> </p>
<p>The population initially consists of all unmarked animals. All fish in the first sample are then marked and returned to the population. The first sample does not necessarily need to be a random sample of the population although the assumptions for the second sample are more likely to be met if it is. In addition, the fish can receive a batch mark, i.e., each fish does not need to be uniquely identified.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> The second sample must be a random sample from the entire population of marked and unmarked individuals such that each fish, whether marked or unmarked, has the same chance of being captured. This also implies that the marked fish mix randomly with the unmarked fish in the population (Figure 1). Each fish in this second sample is examined to determine if it has the mark from the first sample or not.</p>
<p>The summary data for a Petersen estimate can be shown in the format of capture histories (Table 1). However, the more traditional notation of <span class="math inline">\(N=n_{\cdot\cdot}\)</span>, <span class="math inline">\(M=n_{1\cdot}\)</span>, <span class="math inline">\(n=n_{\cdot 1}\)</span>, and <span class="math inline">\(m=n_{11}\)</span> for ease of comparison to other sources will be used throughout these notes.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> Remember that the capitalized symbols refer to the population (i.e., <span class="math inline">\(N\)</span> is number of fish in the population, <span class="math inline">\(M\)</span> is the number of marked fish in the population) whereas the lower-case letters refer to the second sample (i.e., <span class="math inline">\(n\)</span> is the number of fish captured in the second sample, <span class="math inline">\(m\)</span> is the number of marked fish captured in the second sample). The meaning of the symbols used in the Petersen method are shown in Table 2.</p>
<p> </p>
<p>Table 1: Summary data matrix for the two samples in a Petersen mark-recapture framework. Note that a zero indicates the fish were not captured in that sample and a one indicates that the fish were captured in that sample.</p>
<p><img src="Petersen_Data_Matrix.png" /></p>
<p> </p>
<p>Table 2: Summary of notation used in the Petersen method.</p>
<table>
<colgroup>
<col width="10%" />
<col width="89%" />
</colgroup>
<thead>
<tr class="header">
<th>Symbol</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(N\)</span></td>
<td>The unknown size of the population just prior to the first sample.</td>
</tr>
<tr class="even">
<td><span class="math inline">\(M\)</span></td>
<td>The number of fish from the first sample that were marked and returned to the population.</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(n\)</span></td>
<td>The number of fish in the second sample.</td>
</tr>
<tr class="even">
<td><span class="math inline">\(m\)</span></td>
<td>The number of marked fish in the second sample.</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\widehat{N}\)</span></td>
<td>The estimated size of the population just prior to the first sample.</td>
</tr>
</tbody>
</table>
<p> </p>
<p>The Petersen estimate of abundance can be derived from an assumption that if the second sample is a random sample of the population of marked and unmarked animals, then the proportion of marked animals in the second sample should equal the proportion of marked animals in the population, i.e.,</p>
<p><span class="math display">\[ \frac{m}{n} = \frac{M}{N} \]</span></p>
<p>A rearrangement of this equality gives an estimate of the size of the population, i.e.,</p>
<p><span class="math display">\[ \hat{N} = \frac{Mn}{m} \quad \quad \text{(1)} \]</span></p>
<p>Thus, the total population size can be estimated from the number of marked animals, the number of animals observed in the second sample, and the number of animals in the second sample that had the mark.</p>
<p>Approximate confidence intervals for <span class="math inline">\(N\)</span> are often used, with the specific form of the approximation depending on characteristics of the number of marked and recaptured fish.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> <span class="citation">Seber (1982)</span> suggested the following sequential “rules” (i.e., stop at the step where you answer “yes”) for choosing the method for approximating the confidence interval for <span class="math inline">\(N\)</span> in the Petersen method:</p>
<ul>
<li>Is the fraction of marked fish in the second sample “large” (i.e., <span class="math inline">\(\frac{m}{n}&gt;0.10\)</span>)? – Use the <strong>binomial</strong> approximation?</li>
<li>Is the number of marked fish in the second sample “large” (i.e., <span class="math inline">\(m&gt;50\)</span>)? – Use the <strong>normal</strong> approximation?</li>
<li>Use the <strong>Poisson</strong> approximation.</li>
</ul>
<p>Both the binomial and normal approximation methods identify a confidence interval for the ratio of marked fish in the second sample (i.e., <span class="math inline">\(\frac{m}{n}\)</span>) and then the endpoints of these intervals are substituted into the modified Petersen equation,</p>
<p><span class="math display">\[ \hat{N} = \frac{Mn}{m} = \frac{M}{\frac{m}{n}} \]</span></p>
<p>to derive endpoints of the confidence interval for <span class="math inline">\(N\)</span>. The binomial approximation method constructs the interval for <span class="math inline">\(\frac{m}{n}\)</span> with computer algorithms of the binomial distribution. The normal approximation is considered a large-sample method where the standard error for <span class="math inline">\(\frac{m}{n}\)</span> is estimated with</p>
<p><span class="math display">\[ SE_{\frac{m}{n}} = \sqrt{\left(1-\frac{m}{M}\right)\frac{\frac{m}{n}\left(1-\frac{m}{n}\right)}{n-1}} + \frac{1}{2n} \]</span></p>
<p>The confidence interval is then constructed in the usual way with <span class="math inline">\(\frac{m}{n}\pm Z^{*}SE_{\frac{m}{n}}\)</span>.</p>
<p>The Poisson approximation operates similarly, except that it uses computer algorithms of the Poisson distribution to construct a confidence interval for <span class="math inline">\(m\)</span>, the endpoints of which are then substituted back into Equation 1 to derive the confidence interval for <span class="math inline">\(N\)</span>.</p>
</div>
<div id="modifications-of-the-petersen-method" class="section level3">
<h3>Modifications of the Petersen Method</h3>
<p>The Petersen method of estimating abundance is the best asymptotically normal estimator as <span class="math inline">\(N\)</span> approaches infinity but, unfortunately, it is biased, especially for small samples. <span class="citation">Chapman (1951)</span> showed that when <span class="math inline">\(M+n \geq N\)</span> that</p>
<p><span class="math display">\[  \hat{N} = \frac{(M+1)(n+1)}{(m+1)}-1 \quad \quad \text{(2)} \]</span></p>
<p>is an exactly unbiased estimator of <span class="math inline">\(N\)</span>.<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a> If <span class="math inline">\(M+n &lt; N\)</span>, then <span class="citation">Robson and Regier (1964)</span> showed that the bias of Equation 2 is less than 2% if <span class="math inline">\(\frac{Mn}{N}&gt;4\)</span>. Unfortunately, <span class="math inline">\(N\)</span> is usually unknown. However, <span class="citation">Robson and Regier (1964)</span> note that if <span class="math inline">\(m\geq7\)</span> then there is a 95% chance that <span class="math inline">\(\frac{Mn}{N}&gt;4\)</span> and the bias of Equation 2 can be considered negligible <span class="citation">(Seber 1982)</span>. Thus, a given study should be designed so that enough fish are marked and the second sample is large enough to ensure that more than seven marked fish are recaptured.</p>
<p>A final modification was proposed by <span class="citation">Bailey (1951)</span> and <span class="citation">Bailey (1952)</span>. Bailey’s method is appropriate if the second sample of fish is collected with replacement (i.e., an individual may be counted more than once). This type of sampling happens most often if the tagged fish are simply observed rather than captured. Bailey showed that Equation 1 is biased under these conditions and that his modified estimator,</p>
<p><span class="math display">\[ \hat{N} = \frac{(M)(n+1)}{(m+1)} \quad \quad \text{(3)} \]</span></p>
<p>is nearly unbiased if <span class="math inline">\(m\geq7\)</span>.</p>
<p>Confidence intervals for <span class="math inline">\(N\)</span> from these modified estimators use techniques similar to those described for the Petersen method. However, the binomial and normal confidence intervals for the ratio <span class="math inline">\(\frac{m}{n}\)</span> must be converted to a confidence interval for <span class="math inline">\(m\)</span> by multiplying the endpoints by <span class="math inline">\(n\)</span>. The endpoints of the confidence interval for <span class="math inline">\(m\)</span> are then substituted into Equation 2 or Equation 3 to obtain confidence intervals for <span class="math inline">\(N\)</span>.</p>
<p> </p>
<hr />
</div>
<div id="reproducibility-information" class="section level2">
<h2>Reproducibility Information</h2>
<ul>
<li><strong>Compiled Date:</strong> Wed Dec 29 2021</li>
<li><strong>Compiled Time:</strong> 6:39:57 PM</li>
<li><strong>R Version:</strong> R version 4.1.2 (2021-11-01)</li>
<li><strong>System:</strong> Windows, x86_64-w64-mingw32/x64 (64-bit)</li>
<li><strong>Base Packages:</strong> base, datasets, graphics, grDevices, methods, stats, utils</li>
<li><strong>Required Packages:</strong> FSA, captioner, knitr and their dependencies (car, dplyr, dunn.test, evaluate, graphics, grDevices, highr, lmtest, methods, plotrix, sciplot, stats, stringr, tools, utils, withr, xfun, yaml)</li>
<li><strong>Other Packages:</strong> captioner_2.2.3.9000, FSA_0.9.1.9000, knitr_1.36</li>
<li><strong>Loaded-Only Packages:</strong> bslib_0.3.1, compiler_4.1.2, digest_0.6.28, evaluate_0.14, fastmap_1.1.0, htmltools_0.5.2, jquerylib_0.1.4, jsonlite_1.7.2, magrittr_2.0.1, R6_2.5.1, rlang_0.4.12, rmarkdown_2.11, sass_0.4.0, stringi_1.7.5, stringr_1.4.0, tools_4.1.2, xfun_0.28, yaml_2.2.1</li>
<li><strong>Links:</strong> <a href="MarkRecapture1.R">Script</a> / <a href="MarkRecapture1.Rmd">RMarkdown</a></li>
</ul>
<hr />
<p> </p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="unnumbered">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Bailey1951" class="csl-entry">
Bailey, N. T. J. 1951. On estimating the size of mobile populations from capture-recapture data. Biometrika 38:293–306.
</div>
<div id="ref-Bailey1952" class="csl-entry">
Bailey, N. T. J. 1952. Improvements in the interpretation of recapture data. Journal of Animal Ecology 21:120–127.
</div>
<div id="ref-Chapman1951" class="csl-entry">
Chapman, D. G. 1951. Some properties of the hypergeometric distribution with applications to zoological censuses. University of California Publications on Statistics 1:131–160.
</div>
<div id="ref-Jackson1933" class="csl-entry">
Jackson, C. H. N. 1933. On the true density of tsetse flies. Journal of Animal Ecology 2:204–209.
</div>
<div id="ref-Krebs1999" class="csl-entry">
Krebs, C. J. 1999. Ecological methodologySecond. Addison-Welsey Educational Publishing, Menlo Park, CA.
</div>
<div id="ref-Lincoln1930" class="csl-entry">
Lincoln, F. C. 1930. Calculating waterfowl abundance on the basis of banding returns. U.S. Department of Agriculture Circular 118:1–4.
</div>
<div id="ref-Ricker1975" class="csl-entry">
Ricker, W. E. 1975. Computation and interpretation of biological statistics of fish populations. Bulletin of the Fisheries Research Board of Canada.
</div>
<div id="ref-RobsonRegier1964" class="csl-entry">
Robson, D. S., and H. A. Regier. 1964. Sample size in <span>P</span>etersen mark-recapture experiments. Transactions of the American Fisheries Society 93:215–226.
</div>
<div id="ref-Seber1982" class="csl-entry">
Seber, G. A. F. 1982. The estimation of animal abundanceSecond. Edward Arnold.
</div>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>However, it is generally beneficial to uniquely tag each fish.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>The most traditional notation uses <span class="math inline">\(C=n_{\cdot 1}\)</span>, and <span class="math inline">\(R=n_{11}\)</span>. We do not use this notation in order to maintain continuity with subsequent mark-recapture methods.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>Exact confidence intervals for <span class="math inline">\(N\)</span> can generally be derived from the hypergeometric distribution underlying the likelihood function. Unfortunately, there is no simple cumulative distribution for the hypergeometric distribution.<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p><span class="citation">Ricker (1975)</span> modified the Chapman estimator by ignoring the “-1” at the end of the right-hand-side of Equation 2. His argument was that subtracting one is of no practical importance in the estimate. While this argument is understandable, subtracting one to get the exact result proposed by Chapman is not onerous. Therefore, I suggest using the full estimator as proposed by <span class="citation">Chapman (1951)</span>.<a href="#fnref4" class="footnote-back">↩︎</a></p></li>
</ol>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
