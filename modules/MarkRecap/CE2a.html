---
layout: page
title: Class Exercise
subtitle: Mark-Recapture
author: Derek H. Ogle
css: /css/modules.css
---


<hr />
<div id="understanding-the-bias-of-petersen-estimates" class="section level2">
<h2>Understanding the Bias of Petersen Estimates</h2>
<p><img src="http://derekogle.com/NCNRS349/img/computer-1.jpg" alt="Simulations" class="img-right"> Estimating the number of fish in a population is one of the most common tasks facing a fisheries biologist. One common method for estimating fish abundance is to sample the population, mark (or tag) and return the sampled fish to the population, take a second sample from the population, and use the ratio of number of marked to unmarked fish to estimate the population size. The most common formula for estimating abundance in this situation was derived nearly simultaneously by Petersen and Lincoln, though slight modifications to the formulas were derived by Chapman and Bailey. Taken together, these methods are called the “Petersen family” of mark-recapture methods. In this exercise, you will use simulations to assess how accurately the original Petersen and the Chapman modification estimate population abundance.</p>
<div id="simulation-description" class="section level4">
<h4>Simulation Description</h4>
<p>The <code>mrClosed1Sim()</code> function in the <code>FSAsim</code> package may be used to evaluate the performance of the Petersen family of mark-recapture methods to estimate population abundance. This function works by creating an initial population for which abundance is known. A sample of fish is then taken from this population according to choices made by the user (discussed below). The individuals in this sample are then “marked” and returned to the population. A second sample is then taken and the number of previously marked fish is counted. From these results an estimate of population abundance is computed according to the Petersen family method selected by the user. This process is then repeated a large number of times so that the sampling distribution of the population abundance estimate can be visualized.</p>
<p>The <code>mrClosed1Sim()</code> function takes three arguments:</p>
<ul>
<li><code>sim=</code> is used to select the type of simulation to use. Use <code>sim=&quot;distribution&quot;</code> (used on this page) to assess characteristics of the sampling distribution of the population abundance estimate. Use <code>sim=&quot;assumptions&quot;</code> (used on the next pages) to assess the effect of assumptions violations on the population abundance estimate.</li>
<li><code>N=</code> is the known initial population size (default is <code>N=1000</code>).</li>
<li><code>rsmpls=</code> is the number of simulations to run for each scenario (default is <code>rsmpls=2000</code>).</li>
</ul>
<p>After calling the function with <code>sim=&quot;distribution&quot;</code>, a histogram will appear for the estimated population abundance for each of the <code>rsmpls</code> simulations. The histogram is augmented with a red vertical line at the known initial abundance (<code>N</code>) and a green vertical line at the mean estimated abundance from all <code>rsmpls</code> runs. The histogram is also labeled with the percentage error of the mean abundace estimate from the known abundance (positive numbers mean that the known abundance was overestimated, on average).</p>
<pre class="r"><code>&gt; mrClosed1Sim(sim=&quot;distribution&quot;)</code></pre>
<p><img src="CE2a_files/figure-html/unnamed-chunk-3-1.png" width="576" /></p>
<p>For example, the plot above shows that the sampling distribution for the population abundance estimates is right-skewed. In addition, the abundance estimate is biased because the mean abundance estimate is greater than the known initial abundance (the green line is greater than the red line). The bias is an overestimate of 1.8%. In addition, an approximate 95% confidence interval for the abundance estimate is from 777 to 1372 (as shown on the x-axis).</p>
<p>In RStudio, this plot will have a gear icon in the upper-left corner that will open a dialog box that allows you to change the estimation <code>Method</code> (default is <code>Petersen</code>), expected number of fish to tag on the first sample (<code>Marked (M)</code> slider), and the expected number of fish to capture on the second sample (<code>Captured (n)</code> slider). Moving a slider or pressing the <code>Rerandomize</code> button will force another set of <code>rsmpls</code> to be constructed.</p>
<p> </p>
<hr />
</div>
<div id="questions-i-biases" class="section level4">
<h4>Questions I – Biases?</h4>
<p>Each simulation scenario below should be based on a known population size of <code>N=1000</code> individuals (the default), an expected number of marks of 200, and an expected number in the second sample of 200. Once the sliders have been set at the requested levels, the <code>Rerandomize</code> button should be pressed several times to ensure that any conclusions that you draw are not based on the results of a single set of random simulation runs.</p>
<ol>
<li>Does the Petersen method under, over, or accurately estimate the initial population abundance?</li>
<li>Does the Chapman modification method (need to change the “Method” choice) under, over, or accurately estimate the initial population abundance?</li>
<li>Do your answers to the previous two questions change with (a variety of) other expected numbers of marked fish and second sample sample sizes? [i.e., do your conclusions about the Petersen and Chapman methods generalize to “all” sample sizes?]</li>
<li>What main conclusion can you make from your answers to these three questions?</li>
</ol>
<p> </p>
<hr />
</div>
<div id="questions-ii-sampling-distribution" class="section level4">
<h4>Questions II – Sampling Distribution</h4>
<p>Describe the shape of the sampling distribution of the abundance estimate, bias percentage, and <em>width</em> of the approximate confidence interval for each combination of expected number of marks and expected number in the second sample between 100 and 400 in increments of 50. Each simulation should be based on a known population size of <code>N=1000</code> individuals (the default) and use the <strong>Chapman modification method</strong> (not the default). Make sure to rerandomize and record a general result (especially for percent bias). Use your results to answer the questions below. [<em>Hint: You might want to record your observations in a two-way table with expected number of marks as rows and expected number in the second sample as columns.</em>]</p>
<ol>
<li>Describe any obvious patterns in your observations of the percentage bias.</li>
<li>Were there any combinations of values that produced an approximately normal sampling distribution? How does this relate to the general rules for computing confidence intervals for population abundance discussed in the readings?</li>
<li>What happened to the width of the confidence interval as the size of the first sample increased (and the size of the second sample was held constant)?</li>
<li>What happened to the width of the confidence interval as the size of the second sample increased (and the size of the first sample was held constant)?</li>
<li>Suppose that you could only handle a total of 500 fish in the two days of sampling. How should you apportion your effort (expected numbers of fish on the two days) to obtain the most precise (narrowest confidence interval) estimates of population abundance? Does this conclusion generalize to other total sample sizes (e.g., 300 or 400 total fish on the two days)?</li>
<li>What assumptions about field work (i.e., catching and tagging fish) is being made in the previous question? Is this realistic? Explain. How would you incorporate a more realistic scenario into determining how to apportion your effort.</li>
</ol>
<hr />
<div class="text-center">
<ul class="pagination pagination-lg">
<li class="active">
<a href="#">1</a>
</li>
<li>
<a href="CE2b.html">2</a>
</li>
<li>
<a href="CE2c.html">3</a>
</li>
</ul>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
